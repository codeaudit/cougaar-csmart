csmart/data/database/README

This file describes the directory structure containing scripts and data
files necessary for creating a MySQL configuration database used by CSMART.
See csmart/doc/InstallandTest.html or the User's Guide for more information.

Summary:
After creating a database per the instructions referenced above, you load
it with data from files contained here.
For new databases, load the data in the Domain-MySQL.ZIP file.
For new databases, those upgraded from 9.0, or those that you want
to "clean", use ./scripts/mysql/load_1ad_mysql.sh[bat] 
(Run without arguments to see usage.)
To edit the contents of these tables directly (not recommended), edit
the csv files in ./csv

csmart/data/database directory description:

This directory contains several subdirectories as well as a zip file.

Zip file:

"Domain-MySQL.ZIP" contains a datafile called "1ad_domain_data_dump.sql"
which is the sql script to be run to load all domain data tables into 
the CSMART configuration database. If you are upgrading from version
9.0 of Cougaar, you do not need to re-load this data (but it will
not hurt).

Sub-directories:

   csv/:
        Contains a '.csv' file for each table to be created in the 
        configuration database.  These files can be loaded into a
        MySQL database 'as is' or may be modified (eg, in excel) as necessary
        before loading.

   headers/:
        Contains a '.csv' file for each corresponding table/'.csv' file 
        with a single row containing the column headers for each table in
        the database.  These headers are used by the database dump script
        'dump_1ad_mysql.sh' to properly generate 'csv' files containing
        headers.

   scripts/:
        Contains Dos-version GNU sed v3.02

        Contains the subdirectory - 
           mysql/:
                dump_1ad_mysql.sh[bat] - Script for generating a '.csv' file 
                                  in the csmart/data/database/csv directory
                                  for each assembly and cfw/lib table in the 
                                  configuration database.  The script will
                                  check to see if '.csv' files already exist
                                  and if so, requires the user to either 
                                  delete the existing files, or rename the
                                  directory before proceeding.  

                                  The script calls the mysql script 
                                  'dump_db.sql' as well as the 
                                  'concat_header_data.sh[bat]' script.

                                  NOTE: The database user must have the 'File'
                                  privilege in the mysql database in order to 
                                  run this script.  See csmart/doc/InstallandTest.html 
                                  for information on setting this privilege.
                
                dump_db.sql - SQL script that generates a '.csv' file
                                  for each table in the configuration database.
                                  Called by the 'dump_1ad_mysql.sh' script.
                                  It should not be called directly by the user.

                concat_header_data.sh - Called by the 'dump_1ad_mysql.sh' 
                                      script and serves to concatenate the raw data
                                      files generated by the 'dump_1ad_mysql.sh' 
                                      script with the existing header '.csv' files
                                      present in the headers/ directory.  This allows
                                      a user to easily edit the generated '.csv' files.
                                      It should not be called directly by the user.

                load_1ad_mysql.sh[bat] - This script will load the configuration database from
                                  the '.csv' files contained in the csmart/data/database/csv
                                  directory.  The script will drop all existing configuration
                                  database tables before loading the new ones.

                                  The script calls the mysql script load_db.sql'. This script is an
                                   easy way to "clean out" your configuration database.

                load_db.sql -     SQL script that loads the configuration database
                                  from data contained in specified '.csv' files in the
                                  csmart/data/database/csv directory.  It should not be
                                  called directly by the user.


Editing of configuration database:

To edit data contained in the database, a user may directly edit any of the '.csv' files
contained in the csmart/data/database/csv directory and then reload the database. 

For developers:
To edit the structure of any tables contained in the configuration database, a user may
need to edit the following scripts to ensure their continued function:

dump_db.sql
load_db.sql

If modifying or eliminating columns for a given table,  the user should verify that the 
respective header file contained in csmart/data/database/headers/ remains valid. Be sure to edit the 
corresponding .q files in configs/common, and possibly the code that uses them.




